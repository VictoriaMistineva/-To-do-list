{"ast":null,"code":"/* eslint-disable @typescript-eslint/camelcase */\n\n/* eslint-disable no-underscore-dangle */\nimport axios from 'axios';\nimport { v4 } from 'uuid';\nconst STATE_UPDATE_TIMEOUT = 200;\n\nconst createMessage = props => {\n  const messageName = props.data ? 'SERVER_ACTION' : props.name || 'MESSAGE_TO_SKILL';\n  const systemMessage = props.data ? {\n    systemMessage: {\n      data: {\n        app_info: {},\n        server_action: JSON.parse(props.data)\n      }\n    }\n  } : {};\n  const payload = {\n    payload: {\n      applicationId: props.applicationId,\n      appversionId: props.appVersionId,\n      message: props.text ? {\n        original_text: props.text\n      } : {},\n      device: props.config.device || {\n        type: 'SBERBOX',\n        locale: 'ru-RU',\n        timezone: '+03:00',\n        install_id: v4()\n      }\n    }\n  };\n  return Object.assign(Object.assign({\n    messageName,\n    sessionId: props.sessionId,\n    messageId: String(Math.floor(Math.random() * Math.floor(9999999))),\n    meta: {\n      current_app: {\n        state: props.state\n      }\n    },\n    uuid: {\n      userId: props.userId,\n      userChannel: 'FAKE'\n    }\n  }, systemMessage), payload);\n};\n\nconst defaultConfig = {\n  request: {\n    url: 'sberbank.ru'\n  },\n  onRequest: props => props,\n  onResponse: res => res,\n  onError: () => {}\n};\nexport function initializeDebugging(config = defaultConfig) {\n  const currentAppState = {};\n  const sessionId = v4();\n  const userId = v4();\n  const applicationId = v4();\n  const appVersionId = v4();\n\n  const createMessageInSession = props => createMessage(Object.assign({\n    config,\n    userId,\n    sessionId,\n    applicationId,\n    appVersionId,\n    state: currentAppState\n  }, props));\n\n  const ask = props => {\n    var _a, _b;\n\n    return axios({\n      method: ((_a = config.request) === null || _a === void 0 ? void 0 : _a.method) || 'post',\n      url: config.request.url,\n      headers: (_b = config.request) === null || _b === void 0 ? void 0 : _b.headers,\n      data: config.onRequest(createMessageInSession(props))\n    }).then(config.onResponse).then(action => {\n      var _a;\n\n      if (action && ((_a = window.AssistantClient) === null || _a === void 0 ? void 0 : _a.onData)) {\n        window.AssistantClient.onData(action);\n      }\n    }).catch(config.onError);\n  };\n\n  window.AssistantHost = {\n    close() {},\n\n    ready() {\n      setTimeout(() => {\n        var _a;\n\n        if ((_a = window.AssistantClient) === null || _a === void 0 ? void 0 : _a.onStart) window.AssistantClient.onStart();\n      }, 0);\n    },\n\n    sendData(data, name) {\n      ask({\n        data,\n        name: name || undefined\n      });\n    },\n\n    sendDataContainer(container) {\n      const {\n        data,\n        message_name\n      } = JSON.parse(container);\n      ask({\n        data,\n        name: message_name || undefined\n      });\n    },\n\n    setSuggest() {}\n\n  };\n\n  window.__dangerouslyGetAssistantAppState = () => Object.assign({}, currentAppState);\n\n  window.__dangerouslySendVoiceMessage = text => {\n    var _a;\n\n    if ((_a = window.AssistantClient) === null || _a === void 0 ? void 0 : _a.onRequestState) window.AssistantClient.onRequestState();\n    setTimeout(() => ask({\n      text\n    }), STATE_UPDATE_TIMEOUT);\n  }; // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n\n  window.__dangerouslySendDataMessage = (data, name = null) => {\n    var _a;\n\n    return (_a = window.AssistantHost) === null || _a === void 0 ? void 0 : _a.sendData(JSON.stringify(data), name);\n  };\n}","map":{"version":3,"sources":["/home/zelairy/Рабочий стол/todo-canvas-app/node_modules/@sberdevices/assistant-client/dist/debug.js"],"names":["axios","v4","STATE_UPDATE_TIMEOUT","createMessage","props","messageName","data","name","systemMessage","app_info","server_action","JSON","parse","payload","applicationId","appversionId","appVersionId","message","text","original_text","device","config","type","locale","timezone","install_id","Object","assign","sessionId","messageId","String","Math","floor","random","meta","current_app","state","uuid","userId","userChannel","defaultConfig","request","url","onRequest","onResponse","res","onError","initializeDebugging","currentAppState","createMessageInSession","ask","_a","_b","method","headers","then","action","window","AssistantClient","onData","catch","AssistantHost","close","ready","setTimeout","onStart","sendData","undefined","sendDataContainer","container","message_name","setSuggest","__dangerouslyGetAssistantAppState","__dangerouslySendVoiceMessage","onRequestState","__dangerouslySendDataMessage","stringify"],"mappings":"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","sourcesContent":["/* eslint-disable @typescript-eslint/camelcase */\n/* eslint-disable no-underscore-dangle */\nimport axios from 'axios';\nimport { v4 } from 'uuid';\nconst STATE_UPDATE_TIMEOUT = 200;\nconst createMessage = (props) => {\n    const messageName = props.data ? 'SERVER_ACTION' : props.name || 'MESSAGE_TO_SKILL';\n    const systemMessage = props.data\n        ? {\n            systemMessage: {\n                data: {\n                    app_info: {},\n                    server_action: JSON.parse(props.data),\n                },\n            },\n        }\n        : {};\n    const payload = {\n        payload: {\n            applicationId: props.applicationId,\n            appversionId: props.appVersionId,\n            message: props.text\n                ? {\n                    original_text: props.text,\n                }\n                : {},\n            device: props.config.device || {\n                type: 'SBERBOX',\n                locale: 'ru-RU',\n                timezone: '+03:00',\n                install_id: v4(),\n            },\n        },\n    };\n    return Object.assign(Object.assign({ messageName, sessionId: props.sessionId, messageId: String(Math.floor(Math.random() * Math.floor(9999999))), meta: {\n            current_app: {\n                state: props.state,\n            },\n        }, uuid: {\n            userId: props.userId,\n            userChannel: 'FAKE',\n        } }, systemMessage), payload);\n};\nconst defaultConfig = {\n    request: {\n        url: 'sberbank.ru',\n    },\n    onRequest: (props) => props,\n    onResponse: (res) => res,\n    onError: () => { },\n};\nexport function initializeDebugging(config = defaultConfig) {\n    const currentAppState = {};\n    const sessionId = v4();\n    const userId = v4();\n    const applicationId = v4();\n    const appVersionId = v4();\n    const createMessageInSession = (props) => createMessage(Object.assign({ config,\n        userId,\n        sessionId,\n        applicationId,\n        appVersionId, state: currentAppState }, props));\n    const ask = (props) => {\n        var _a, _b;\n        return axios({\n            method: ((_a = config.request) === null || _a === void 0 ? void 0 : _a.method) || 'post',\n            url: config.request.url,\n            headers: (_b = config.request) === null || _b === void 0 ? void 0 : _b.headers,\n            data: config.onRequest(createMessageInSession(props)),\n        })\n            .then(config.onResponse)\n            .then((action) => {\n            var _a;\n            if (action && ((_a = window.AssistantClient) === null || _a === void 0 ? void 0 : _a.onData)) {\n                window.AssistantClient.onData(action);\n            }\n        })\n            .catch(config.onError);\n    };\n    window.AssistantHost = {\n        close() { },\n        ready() {\n            setTimeout(() => {\n                var _a;\n                if ((_a = window.AssistantClient) === null || _a === void 0 ? void 0 : _a.onStart)\n                    window.AssistantClient.onStart();\n            }, 0);\n        },\n        sendData(data, name) {\n            ask({\n                data,\n                name: name || undefined,\n            });\n        },\n        sendDataContainer(container) {\n            const { data, message_name } = JSON.parse(container);\n            ask({\n                data,\n                name: message_name || undefined,\n            });\n        },\n        setSuggest() { },\n    };\n    window.__dangerouslyGetAssistantAppState = () => (Object.assign({}, currentAppState));\n    window.__dangerouslySendVoiceMessage = (text) => {\n        var _a;\n        if ((_a = window.AssistantClient) === null || _a === void 0 ? void 0 : _a.onRequestState)\n            window.AssistantClient.onRequestState();\n        setTimeout(() => ask({\n            text,\n        }), STATE_UPDATE_TIMEOUT);\n    };\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    window.__dangerouslySendDataMessage = (data, name = null) => { var _a; return (_a = window.AssistantHost) === null || _a === void 0 ? void 0 : _a.sendData(JSON.stringify(data), name); };\n}\n"]},"metadata":{},"sourceType":"module"}